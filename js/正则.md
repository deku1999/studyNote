# 正则

## 介绍

正则表达式(regular expression)：就是用某种模式去匹配某一类字符串的公式；学习正则表达式就是学习怎样定义一种“模式”的语法，说白了，就是学习各种匹配的规则，例如匹配数字要怎么要怎么写，匹配字符怎么写等等；正则表达式常见于表单验证、字符串操作。

## 正则表达式创建

- 一是构造函数new RegExp()，接收两个参数一个是要匹配的字符串模式一个是可选的标志字符串。
- 另一个是字面量定义，var express = /pattern/flags;其中pattern就是正则表达式，flags即标志，可以有一个或多个，例如g，i，m，参见p103。
- es6新添加了u，y修饰符。u修饰符代表Unicode 模式，用来正确处理大于`\uFFFF`的 Unicode 字符。也就是说，会正确处理四个字节的 UTF-16 编码。例如`/^\uD83D/u.test('\uD83D\uDC2A')   // false`。

`y`修饰符的作用与`g`修饰符类似，也是全局匹配，后一次匹配都从上一次匹配成功的下一个位置开始。不同之处在于，`g`修饰符只要剩余位置中存在匹配就可，而`y`修饰符确保匹配必须从剩余的第一个位置开始，这也就是“粘连”的涵义。

```javascript
var s = 'aaa_aa_a';
var r1 = /a+/g;
var r2 = /a+/y;

r1.exec(s) // ["aaa"]
r2.exec(s) // ["aaa"]

r1.exec(s) // ["aa"]
r2.exec(s) // null
```

上面代码有两个正则表达式，一个使用`g`修饰符，另一个使用`y`修饰符。这两个正则表达式各执行了两次，第一次执行的时候，两者行为相同，剩余字符串都是`_aa_a`。由于`g`修饰没有位置要求，所以第二次执行会返回结果，而`y`修饰符要求匹配必须从头部开始，所以返回`null`。

## 正则表达式方法

- RegExp类型具有很多属性取得有关模式的各种信息，例如global，source，lastIndex等，参见p105。
- 捕获组方法exec()，参见p106；测试方法test()，接收字符串参数判断是否符合正则表达式模式，返回布尔值

## 正则语法

### 常用元字符

| 常用元字符 | 含义                                                         |
| ---------- | ------------------------------------------------------------ |
| \d         | 匹配数字，相当于[0-9]                                        |
| \D         | 匹配非数字，相当于[(^)0-9]，这里的括号是多余的只是不加会被编辑器解释为上标可以直接当作没有 |
| \w         | 匹配字母或数字或汉字或下划线                                 |
| \W         | 匹配任意不是字母、数字、汉字或下划线的字符                   |
| \s         | 匹配任意的空白符，如空格、换行符、制表符等                   |
| \S         | 匹配任意不是空白符的字符                                     |
| .          | 匹配除了换行符以外的任意字符                                 |
| [...]      | 匹配方括号中的所有字符                                       |
| [^...]     | 匹配非方括号中的所有字符                                     |

### 连接符

| 连接符      | 含义               |
| ----------- | ------------------ |
| [0-9]       | 匹配数字，等价于\d |
| [a-z]       | 匹配英文小写字母   |
| [A-Z]       | 匹配英文大写字母   |
| [0-9a-zA-z] | 匹配数字或英文字母 |

### 限定符

- 就是限定某个或某类字符出现的次数，一般加在元字符或连接符或某个字符后面来限定次数

| 限定符 | 含义                        |
| ------ | --------------------------- |
| +      | 重复1次或更多次             |
| *      | 重复0次或更多次（任意次数） |
| ?      | 重复0次或1次（最多1次）     |
| {n}    | 重复n次                     |
| {n,}   | 重复n次或更多次（最少n次）  |
| {n,m}  | 重复n到m次                  |

### 定位符

- 限定某些字符出现的位置

| 定位符 | 含义                       |
| ------ | -------------------------- |
| ^      | 限定开始位置的字符         |
| $      | 限定结尾位置的字符         |
| \b     | 限定单词（字）边界的字符   |
| \B     | 限定非单词（字）边界的字符 |

### 转义字符

- 我们都知道正则表达式包括2种字符，普通字符，特殊字符。如果我们要匹配正则表达式中的特殊字符，我们就必须在该特殊字符前面加上反斜杠“\”将其进行转义。
- 例如我们想匹配go+，要这样写go\+，因为+本身就是正则的限定符。例如要匹配字面意义的“\”，就需要使用“\\”表示。需要转义的字符有：$、(、)、*、+、.、[、]、?、\、/、^、{、}、|。这些字符都不需要记忆，见得多就自然而然记住了。

### 捕获组

- 用小括号将你需要的部分括起来就称为一个捕获组。正则表达式本身就是一个下标为0的捕获组。
- 捕获组除了让内容成为一个整体进行操作，也是Exp对象的exec，String对象的match方法的重要基础，这两个方法都可以用来在从字符串通过捕获组提取特定字符。

```javascript
//这里仅以exp对象的exec方法举例
var text = "mom and dad and baby"
//该正则对象包括本身共有三个捕获组
var pattern = /mom (and dad( and baby)?)?/gi
//返回一个类数组，第一项是与整个模式匹配的字符串，其他项就是与模式中的捕获组匹配的字符串(如果模式中只有正则表达式本身这一捕获组，那么该数组就只有一项)
var matches = pattern.exec(text)
console.log(matched[0])		//mom and dad and baby
console.log(matched[1])		//and dad and baby
console.log(matched[2])		// and baby
```

### 选择符

- 在正则表达式中，选择匹配符是“|”，用于选择匹配2个选项之中的任意一个，类似JavaScript中的“或”运算。例如，“abc|def1”匹配的是“abc”或“def1”，而不是“abc1”或“def1”。

### 优先级顺序

- \	转义符
- ()、(?:)、(?=)、[]	圆括号或方括号
- *、+、?、{n}、{n,}、{n,m}	限定符
- ^、$、\b、\B	位置和顺序
- |	选择符，“或”运算

上述优先级从高到低排列